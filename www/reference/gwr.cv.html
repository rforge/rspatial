<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Crossvalidation of bandwidth for geographically weighted regression — gwr.sel • spgwr</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Crossvalidation of bandwidth for geographically weighted regression — gwr.sel" />

<meta property="og:description" content="The function finds a bandwidth for a given geographically weighted regression
by optimzing a selected function. For cross-validation, this scores the root mean square
prediction error for the geographically weighted regressions, choosing the
bandwidth minimizing this quantity." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">spgwr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.6.32</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Crossvalidation of bandwidth for geographically weighted regression</h1>
    
    <div class="hidden name"><code>gwr.cv.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>The function finds a bandwidth for a given geographically weighted regression
by optimzing a selected function. For cross-validation, this scores the root mean square
prediction error for the geographically weighted regressions, choosing the
bandwidth minimizing this quantity.</p>
    
    </div>

    <pre class="usage"><span class='fu'>gwr.sel</span>(<span class='no'>formula</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(), <span class='no'>coords</span>, <span class='kw'>adapt</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>gweight</span><span class='kw'>=</span><span class='no'>gwr.Gauss</span>,
 <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"cv"</span>, <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>longlat</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>RMSE</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='no'>weights</span>,
 <span class='kw'>tol</span><span class='kw'>=</span><span class='no'>.Machine</span>$<span class='no'>double.eps</span>^<span class='fl'>0.25</span>, <span class='kw'>show.error.messages</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>formula</th>
      <td><p>regression model formula as in <code>lm</code></p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>model data frame as in <code>lm</code>, or may be a SpatialPointsDataFrame or SpatialPolygonsDataFrame object as defined in package <span class="pkg">sp</span></p></td>
    </tr>
    <tr>
      <th>coords</th>
      <td><p>matrix of coordinates of points representing the spatial
  positions of the observations</p></td>
    </tr>
    <tr>
      <th>adapt</th>
      <td><p>either TRUE: find the proportion between 0 and 1 of observations to include in weighting scheme (k-nearest neighbours), or FALSE --- find global bandwidth</p></td>
    </tr>
    <tr>
      <th>gweight</th>
      <td><p>geographical weighting function, at present 
  <code><a href='gwr.gauss.html'>gwr.Gauss()</a></code> default, or <code><a href='gwr.gauss.html'>gwr.gauss()</a></code>, the previous default or <code><a href='gwr.bisquare.html'>gwr.bisquare()</a></code></p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>default "cv" for drop-1 cross-validation, or "aic" for AIC optimisation (depends on assumptions about AIC degrees of freedom)</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>if TRUE (default), reports the progress of search for bandwidth</p></td>
    </tr>
    <tr>
      <th>longlat</th>
      <td><p>TRUE if point coordinates are longitude-latitude decimal degrees, in which case distances are measured in kilometers; if x is a SpatialPoints object, the value is taken from the object itself</p></td>
    </tr>
    <tr>
      <th>RMSE</th>
      <td><p>default FALSE to correspond with CV scores in newer references (sum of squared CV errors), if TRUE the previous behaviour of scoring by LOO CV RMSE</p></td>
    </tr>
    <tr>
      <th>weights</th>
      <td><p>case weights used as in weighted least squares, beware of scaling issues --- only used with the cross-validation method, probably unsafe</p></td>
    </tr>
    <tr>
      <th>tol</th>
      <td><p>the desired accuracy to be passed to <code>optimize</code></p></td>
    </tr>
    <tr>
      <th>show.error.messages</th>
      <td><p>default FALSE; may be set to TRUE to see error messages if <code>gwr.sel</code> returns without a value</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>If the regression contains little pattern, the bandwidth will converge to the upper bound of the line search, which is the diagonal of the bounding box of the data point coordinates for &#8220;adapt=FALSE&#8221;, and 1 for &#8220;adapt=TRUE&#8221;; see the simulation block in the examples below.</p>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>returns the cross-validation bandwidth.</p>
    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>Use of method="aic" results in the creation of an n by n matrix, and should not be chosen when n is large.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Fotheringham, A.S., Brunsdon, C., and Charlton, M.E., 2002,
Geographically Weighted Regression, Chichester: Wiley; Paez A, Farber S, Wheeler D, 2011, "A simulation-based study of geographically weighted regression as a method for investigating spatially varying relationships", Environment and
Planning A 43(12) 2992-3010;
<a href='http://gwr.nuim.ie/'>http://gwr.nuim.ie/</a></p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='gwr.bisquare.html'>gwr.bisquare</a></code>, <code><a href='gwr.gauss.html'>gwr.gauss</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='no'>columbus</span>, <span class='kw'>package</span><span class='kw'>=</span><span class='st'>"spData"</span>)
<span class='fu'>gwr.sel</span>(<span class='no'>CRIME</span> ~ <span class='no'>INC</span> + <span class='no'>HOVAL</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>columbus</span>,
  <span class='kw'>coords</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/cbind'>cbind</a></span>(<span class='no'>columbus</span>$<span class='no'>X</span>, <span class='no'>columbus</span>$<span class='no'>Y</span>))</div><div class='output co'>#&gt; Bandwidth: 12.65221 CV score: 7432.209 
#&gt; Bandwidth: 20.45127 CV score: 7462.704 
#&gt; Bandwidth: 7.83213 CV score: 7323.545 
#&gt; Bandwidth: 4.853154 CV score: 7307.57 
#&gt; Bandwidth: 5.125504 CV score: 7322.796 
#&gt; Bandwidth: 3.012046 CV score: 6461.764 
#&gt; Bandwidth: 1.874179 CV score: 6473.378 
#&gt; Bandwidth: 2.475485 CV score: 6109.995 
#&gt; Bandwidth: 2.447721 CV score: 6098.372 
#&gt; Bandwidth: 2.228647 CV score: 6064.1 
#&gt; Bandwidth: 2.264538 CV score: 6060.774 
#&gt; Bandwidth: 2.280666 CV score: 6060.649 
#&gt; Bandwidth: 2.274969 CV score: 6060.601 
#&gt; Bandwidth: 2.2751 CV score: 6060.601 
#&gt; Bandwidth: 2.27506 CV score: 6060.601 
#&gt; Bandwidth: 2.275019 CV score: 6060.601 
#&gt; Bandwidth: 2.27506 CV score: 6060.601 </div><div class='output co'>#&gt; [1] 2.27506</div><div class='input'><span class='fu'>gwr.sel</span>(<span class='no'>CRIME</span> ~ <span class='no'>INC</span> + <span class='no'>HOVAL</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>columbus</span>,
  <span class='kw'>coords</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/cbind'>cbind</a></span>(<span class='no'>columbus</span>$<span class='no'>X</span>, <span class='no'>columbus</span>$<span class='no'>Y</span>), <span class='kw'>gweight</span><span class='kw'>=</span><span class='no'>gwr.bisquare</span>)</div><div class='output co'>#&gt; Bandwidth: 12.65221 CV score: 8180.619 
#&gt; Bandwidth: 20.45127 CV score: 7552.85 
#&gt; Bandwidth: 25.27136 CV score: 7508.227 
#&gt; Bandwidth: 23.68132 CV score: 7519.864 
#&gt; Bandwidth: 28.25033 CV score: 7491.85 
#&gt; Bandwidth: 30.09144 CV score: 7486.673 
#&gt; Bandwidth: 31.69353 CV score: 7483.663 
#&gt; Bandwidth: 31.08159 CV score: 7484.706 
#&gt; Bandwidth: 32.21945 CV score: 7482.846 
#&gt; Bandwidth: 32.54449 CV score: 7482.371 
#&gt; Bandwidth: 32.74538 CV score: 7482.088 
#&gt; Bandwidth: 32.86953 CV score: 7481.916 
#&gt; Bandwidth: 32.94626 CV score: 7481.812 
#&gt; Bandwidth: 32.99368 CV score: 7481.748 
#&gt; Bandwidth: 33.02299 CV score: 7481.708 
#&gt; Bandwidth: 33.04111 CV score: 7481.684 
#&gt; Bandwidth: 33.0523 CV score: 7481.669 
#&gt; Bandwidth: 33.05922 CV score: 7481.659 
#&gt; Bandwidth: 33.0635 CV score: 7481.654 
#&gt; Bandwidth: 33.06614 CV score: 7481.65 
#&gt; Bandwidth: 33.06777 CV score: 7481.648 
#&gt; Bandwidth: 33.06878 CV score: 7481.647 
#&gt; Bandwidth: 33.06941 CV score: 7481.646 
#&gt; Bandwidth: 33.06979 CV score: 7481.645 
#&gt; Bandwidth: 33.07003 CV score: 7481.645 
#&gt; Bandwidth: 33.07018 CV score: 7481.645 
#&gt; Bandwidth: 33.07027 CV score: 7481.645 
#&gt; Bandwidth: 33.07032 CV score: 7481.645 
#&gt; Bandwidth: 33.07037 CV score: 7481.645 
#&gt; Bandwidth: 33.07037 CV score: 7481.645 </div><div class='output co'>#&gt; <span class='warning'>Warning: Bandwidth converged to upper bound:33.0704149683672</span></div><div class='output co'>#&gt; [1] 33.07037</div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='no'>georgia</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Random'>set.seed</a></span>(<span class='fl'>1</span>)
<span class='no'>X0</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Uniform'>runif</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/nrow'>nrow</a></span>(<span class='no'>gSRDF</span>)*<span class='fl'>3</span>)
<span class='no'>X1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/matrix'>matrix</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/sample'>sample</a></span>(<span class='no'>X0</span>), <span class='kw'>ncol</span><span class='kw'>=</span><span class='fl'>3</span>)
<span class='no'>X1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/prcomp'>prcomp</a></span>(<span class='no'>X1</span>, <span class='kw'>center</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>scale.</span><span class='kw'>=</span><span class='fl'>FALSE</span>)$<span class='no'>x</span>
<span class='no'>gSRDF</span>$<span class='no'>X1</span> <span class='kw'>&lt;-</span> <span class='no'>X1</span>[,<span class='fl'>1</span>]
<span class='no'>gSRDF</span>$<span class='no'>X2</span> <span class='kw'>&lt;-</span> <span class='no'>X1</span>[,<span class='fl'>2</span>]
<span class='no'>gSRDF</span>$<span class='no'>X3</span> <span class='kw'>&lt;-</span> <span class='no'>X1</span>[,<span class='fl'>3</span>]
<span class='no'>yrn</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Normal'>rnorm</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/nrow'>nrow</a></span>(<span class='no'>gSRDF</span>))
<span class='no'>gSRDF</span>$<span class='no'>yrn</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/sample'>sample</a></span>(<span class='no'>yrn</span>)
<span class='no'>bw</span> <span class='kw'>&lt;-</span> <span class='fu'>gwr.sel</span>(<span class='no'>yrn</span> ~ <span class='no'>X1</span> + <span class='no'>X2</span> + <span class='no'>X3</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>gSRDF</span>, <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"cv"</span>, <span class='kw'>adapt</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>verbose</span><span class='kw'>=</span><span class='fl'>FALSE</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: Bandwidth converged to upper bound:620.559306125037</span></div><div class='input'><span class='no'>bw</span></div><div class='output co'>#&gt; [1] 620.5592</div><div class='input'><span class='no'>bw</span> <span class='kw'>&lt;-</span> <span class='fu'>gwr.sel</span>(<span class='no'>yrn</span> ~ <span class='no'>X1</span> + <span class='no'>X2</span> + <span class='no'>X3</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>gSRDF</span>, <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"aic"</span>, <span class='kw'>adapt</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>verbose</span><span class='kw'>=</span><span class='fl'>FALSE</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: Bandwidth converged to upper bound:620.559306125037</span></div><div class='input'><span class='no'>bw</span></div><div class='output co'>#&gt; [1] 620.5592</div><div class='input'><span class='no'>bw</span> <span class='kw'>&lt;-</span> <span class='fu'>gwr.sel</span>(<span class='no'>yrn</span> ~ <span class='no'>X1</span> + <span class='no'>X2</span> + <span class='no'>X3</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>gSRDF</span>, <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"cv"</span>, <span class='kw'>adapt</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>verbose</span><span class='kw'>=</span><span class='fl'>FALSE</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: Bandwidth converged to upper bound:1</span></div><div class='input'><span class='no'>bw</span></div><div class='output co'>#&gt; [1] 0.9999339</div><div class='input'><span class='no'>bw</span> <span class='kw'>&lt;-</span> <span class='fu'>gwr.sel</span>(<span class='no'>yrn</span> ~ <span class='no'>X1</span> + <span class='no'>X2</span> + <span class='no'>X3</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>gSRDF</span>, <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"aic"</span>, <span class='kw'>adapt</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>verbose</span><span class='kw'>=</span><span class='fl'>FALSE</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: Bandwidth converged to upper bound:1</span></div><div class='input'><span class='no'>bw</span></div><div class='output co'>#&gt; [1] 0.9999339</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>

      <li><a href="#value">Value</a></li>

      <li><a href="#note">Note</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Roger Bivand <a href='mailto:Roger.Bivand@nhh.no'>Roger.Bivand@nhh.no</a></p>
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Roger Bivand, Danlin Yu.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

