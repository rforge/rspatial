<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Geographically weighted regression — gwr • spgwr</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Geographically weighted regression — gwr" />

<meta property="og:description" content="The function implements the basic geographically weighted regression approach
to exploring spatial non-stationarity for given global bandwidth and chosen
weighting scheme." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">spgwr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.6.32</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Geographically weighted regression</h1>
    
    <div class="hidden name"><code>gwr.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>The function implements the basic geographically weighted regression approach
to exploring spatial non-stationarity for given global bandwidth and chosen
weighting scheme.</p>
    
    </div>

    <pre class="usage">gwr(formula, data=list(), coords, bandwidth, gweight=gwr.Gauss, 
	adapt=NULL, hatmatrix = FALSE, fit.points, longlat=NULL, 
	se.fit=FALSE, weights, cl=NULL, predictions = FALSE, 
        fittedGWRobject = NULL, se.fit.CCT = TRUE)
# S3 method for gwr
print(x, &#8230;)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>formula</th>
      <td><p>regression model formula as in <code>lm</code></p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>model data frame, or SpatialPointsDataFrame or SpatialPolygonsDataFrame as defined in package <span class="pkg">sp</span></p></td>
    </tr>
    <tr>
      <th>coords</th>
      <td><p>matrix of coordinates of points representing the spatial
  positions of the observations; may be omitted if the object passed through the data argument is from package <span class="pkg">sp</span></p></td>
    </tr>
    <tr>
      <th>bandwidth</th>
      <td><p>bandwidth used in the weighting function, possibly
  calculated by <code>gwr.sel</code></p></td>
    </tr>
    <tr>
      <th>gweight</th>
      <td><p>geographical weighting function, at present 
  <code><a href='gwr.gauss.html'>gwr.Gauss()</a></code> default, or <code><a href='gwr.gauss.html'>gwr.gauss()</a></code>, the previous default or <code><a href='gwr.bisquare.html'>gwr.bisquare()</a></code></p></td>
    </tr>
    <tr>
      <th>adapt</th>
      <td><p>either NULL (default) or a proportion between 0 and 1 of observations to include in weighting scheme (k-nearest neighbours)</p></td>
    </tr>
    <tr>
      <th>hatmatrix</th>
      <td><p>if TRUE, return the hatmatrix as a component of the result, ignored if <code>fit.points</code> given</p></td>
    </tr>
    <tr>
      <th>fit.points</th>
      <td><p>an object containing the coordinates of fit points; often an object from package <span class="pkg">sp</span>; if missing, the coordinates given through the data argument object, or the coords argument are used</p></td>
    </tr>
    <tr>
      <th>longlat</th>
      <td><p>TRUE if point coordinates are longitude-latitude decimal degrees, in which case distances are measured in kilometers; if x is a SpatialPoints object, the value is taken from the object itself</p></td>
    </tr>
    <tr>
      <th>se.fit</th>
      <td><p>if TRUE, return local coefficient standard errors - if <code>hatmatrix</code> is TRUE and no fit.points are given, two effective degrees of freedom sigmas will be used to generate alternative coefficient standard errors</p></td>
    </tr>
    <tr>
      <th>weights</th>
      <td><p>case weights used as in weighted least squares, beware of scaling issues, probably unsafe</p></td>
    </tr>
    <tr>
      <th>cl</th>
      <td><p>if NULL, ignored, otherwise <code>cl</code> must be an object describing a &#8220;cluster&#8221; created using <code>makeCluster</code> in the <span class="pkg">parallel</span> package. The cluster will then be used to hand off the calculation of local coefficients to cluster nodes, if fit points have been given as an argument, and <code>hatmatrix=FALSE</code></p></td>
    </tr>
    <tr>
      <th>predictions</th>
      <td><p>default FALSE; if TRUE and no fit points given, return GW fitted values at data points, if fit points given and are a Spatial*DataFrame object containing the RHS variables in the formula, return GW predictions at the fit points</p></td>
    </tr>
    <tr>
      <th>fittedGWRobject</th>
      <td><p>a fitted <code>gwr</code> object with a hatmatrix (optional), if given, and if fit.points are given and if <code>se.fit</code> is TRUE, two effective degrees of freedom sigmas will be used to generate alternative coefficient standard errors</p></td>
    </tr>
    <tr>
      <th>se.fit.CCT</th>
      <td><p>default TRUE, compute local coefficient standard errors using formula (2.14), p. 55, in the GWR book</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>an object of class "gwr" returned by the <code>gwr</code> function</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>arguments to be passed to other functions</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The function applies the weighting function in turn to each of the 
observations, or fit points if given, calculating a weighted regression 
for each point. The results may be explored to see if coefficient values vary over space. The local coefficient estimates may be made on a multi-node cluster using the <code>cl</code> argument to pass through a <span class="pkg">parallel</span> cluster. The function will then divide the fit points (which must be given separately) between the clusters for fitting. Note that each node will need to have the &#8220;spgwr&#8221; package present, so initiating by <code><a href='https://www.rdocumentation.org/packages/parallel/topics/clusterApply'>clusterEvalQ(cl, library(spgwr))</a></code> may save a little time per node. The function clears the global environment on the node of objects sent. Using two nodes reduces timings to a little over half the time for a single node.</p>
<p>The section of the examples code now includes two simulation scenarios, showing how important it is to check that mapped pattern in local coefficients is actually there, rather than being an artefact.</p>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list of class &#8220;gwr&#8221;:</p>
<dt>SDF</dt><dd><p>a SpatialPointsDataFrame (may be gridded) or SpatialPolygonsDataFrame object (see package "sp") with fit.points, weights, GWR coefficient estimates, R-squared, and coefficient standard errors in its "data" slot.</p></dd>
  <dt>lhat</dt><dd><p>Leung et al. L matrix</p></dd>
  <dt>lm</dt><dd><p>Ordinary least squares global regression on the same model formula, as returned by lm.wfit().</p></dd>
  <dt>bandwidth</dt><dd><p>the bandwidth used.</p></dd>
  <dt>this.call</dt><dd><p>the function call used.</p></dd>

    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Fotheringham, A.S., Brunsdon, C., and Charlton, M.E., 2002,
Geographically Weighted Regression, Chichester: Wiley; Paez A, Farber S, Wheeler D, 2011, "A simulation-based study of geographically weighted regression as a method for investigating spatially varying relationships", Environment and
Planning A 43(12) 2992-3010;
<a href='http://gwr.nuim.ie/'>http://gwr.nuim.ie/</a></p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='gwr.cv.html'>gwr.sel</a></code>, <code><a href='gwr.gauss.html'>gwr.gauss</a></code>,
<code><a href='gwr.bisquare.html'>gwr.bisquare</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='no'>columbus</span>, <span class='kw'>package</span><span class='kw'>=</span><span class='st'>"spData"</span>)
<span class='no'>col.lm</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/lm'>lm</a></span>(<span class='no'>CRIME</span> ~ <span class='no'>INC</span> + <span class='no'>HOVAL</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>columbus</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>col.lm</span>)</div><div class='output co'>#&gt; 
#&gt; Call:
#&gt; lm(formula = CRIME ~ INC + HOVAL, data = columbus)
#&gt; 
#&gt; Residuals:
#&gt;     Min      1Q  Median      3Q     Max 
#&gt; -34.418  -6.388  -1.580   9.052  28.649 
#&gt; 
#&gt; Coefficients:
#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    
#&gt; (Intercept)  68.6190     4.7355  14.490  &lt; 2e-16 ***
#&gt; INC          -1.5973     0.3341  -4.780 1.83e-05 ***
#&gt; HOVAL        -0.2739     0.1032  -2.654   0.0109 *  
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
#&gt; 
#&gt; Residual standard error: 11.43 on 46 degrees of freedom
#&gt; Multiple R-squared:  0.5524,	Adjusted R-squared:  0.5329 
#&gt; F-statistic: 28.39 on 2 and 46 DF,  p-value: 9.341e-09
#&gt; </div><div class='input'><span class='no'>col.bw</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='gwr.cv.html'>gwr.sel</a></span>(<span class='no'>CRIME</span> ~ <span class='no'>INC</span> + <span class='no'>HOVAL</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>columbus</span>,
  <span class='kw'>coords</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/cbind'>cbind</a></span>(<span class='no'>columbus</span>$<span class='no'>X</span>, <span class='no'>columbus</span>$<span class='no'>Y</span>))</div><div class='output co'>#&gt; Bandwidth: 12.65221 CV score: 7432.209 
#&gt; Bandwidth: 20.45127 CV score: 7462.704 
#&gt; Bandwidth: 7.83213 CV score: 7323.545 
#&gt; Bandwidth: 4.853154 CV score: 7307.57 
#&gt; Bandwidth: 5.125504 CV score: 7322.796 
#&gt; Bandwidth: 3.012046 CV score: 6461.764 
#&gt; Bandwidth: 1.874179 CV score: 6473.378 
#&gt; Bandwidth: 2.475485 CV score: 6109.995 
#&gt; Bandwidth: 2.447721 CV score: 6098.372 
#&gt; Bandwidth: 2.228647 CV score: 6064.1 
#&gt; Bandwidth: 2.264538 CV score: 6060.774 
#&gt; Bandwidth: 2.280666 CV score: 6060.649 
#&gt; Bandwidth: 2.274969 CV score: 6060.601 
#&gt; Bandwidth: 2.2751 CV score: 6060.601 
#&gt; Bandwidth: 2.27506 CV score: 6060.601 
#&gt; Bandwidth: 2.275019 CV score: 6060.601 
#&gt; Bandwidth: 2.27506 CV score: 6060.601 </div><div class='input'><span class='no'>col.gauss</span> <span class='kw'>&lt;-</span> <span class='fu'>gwr</span>(<span class='no'>CRIME</span> ~ <span class='no'>INC</span> + <span class='no'>HOVAL</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>columbus</span>,
  <span class='kw'>coords</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/cbind'>cbind</a></span>(<span class='no'>columbus</span>$<span class='no'>X</span>, <span class='no'>columbus</span>$<span class='no'>Y</span>), <span class='kw'>bandwidth</span><span class='kw'>=</span><span class='no'>col.bw</span>, <span class='kw'>hatmatrix</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='no'>col.gauss</span></div><div class='output co'>#&gt; Call:
#&gt; gwr(formula = CRIME ~ INC + HOVAL, data = columbus, coords = cbind(columbus$X, 
#&gt;     columbus$Y), bandwidth = col.bw, hatmatrix = TRUE)
#&gt; Kernel function: gwr.Gauss 
#&gt; Fixed bandwidth: 2.27506 
#&gt; Summary of GWR coefficient estimates at data points:
#&gt;                   Min.   1st Qu.    Median   3rd Qu.      Max.  Global
#&gt; X.Intercept. 23.233234 54.124872 63.902588 68.756460 80.900619 68.6190
#&gt; INC          -3.130714 -1.912908 -0.984380 -0.368564  1.291075 -1.5973
#&gt; HOVAL        -1.052811 -0.376735 -0.097394  0.030049  0.794577 -0.2739
#&gt; Number of data points: 49 
#&gt; Effective number of parameters (residual: 2traceS - traceS'S): 29.6163 
#&gt; Effective degrees of freedom (residual: 2traceS - traceS'S): 19.3837 
#&gt; Sigma (residual: 2traceS - traceS'S): 8.027502 
#&gt; Effective number of parameters (model: traceS): 23.92796 
#&gt; Effective degrees of freedom (model: traceS): 25.07204 
#&gt; Sigma (model: traceS): 7.058361 
#&gt; Sigma (ML): 5.048946 
#&gt; AICc (GWR p. 61, eq 2.33; p. 96, eq. 4.21): 403.6187 
#&gt; AIC (GWR p. 96, eq. 4.22): 321.6635 
#&gt; Residual sum of squares: 1249.101 
#&gt; Quasi-global R2: 0.9070486 </div><div class='input'><span class='no'>col.d</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='gwr.cv.html'>gwr.sel</a></span>(<span class='no'>CRIME</span> ~ <span class='no'>INC</span> + <span class='no'>HOVAL</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>columbus</span>,
  <span class='kw'>coords</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/cbind'>cbind</a></span>(<span class='no'>columbus</span>$<span class='no'>X</span>, <span class='no'>columbus</span>$<span class='no'>Y</span>), <span class='kw'>gweight</span><span class='kw'>=</span><span class='no'>gwr.bisquare</span>)</div><div class='output co'>#&gt; Bandwidth: 12.65221 CV score: 8180.619 
#&gt; Bandwidth: 20.45127 CV score: 7552.85 
#&gt; Bandwidth: 25.27136 CV score: 7508.227 
#&gt; Bandwidth: 23.68132 CV score: 7519.864 
#&gt; Bandwidth: 28.25033 CV score: 7491.85 
#&gt; Bandwidth: 30.09144 CV score: 7486.673 
#&gt; Bandwidth: 31.69353 CV score: 7483.663 
#&gt; Bandwidth: 31.08159 CV score: 7484.706 
#&gt; Bandwidth: 32.21945 CV score: 7482.846 
#&gt; Bandwidth: 32.54449 CV score: 7482.371 
#&gt; Bandwidth: 32.74538 CV score: 7482.088 
#&gt; Bandwidth: 32.86953 CV score: 7481.916 
#&gt; Bandwidth: 32.94626 CV score: 7481.812 
#&gt; Bandwidth: 32.99368 CV score: 7481.748 
#&gt; Bandwidth: 33.02299 CV score: 7481.708 
#&gt; Bandwidth: 33.04111 CV score: 7481.684 
#&gt; Bandwidth: 33.0523 CV score: 7481.669 
#&gt; Bandwidth: 33.05922 CV score: 7481.659 
#&gt; Bandwidth: 33.0635 CV score: 7481.654 
#&gt; Bandwidth: 33.06614 CV score: 7481.65 
#&gt; Bandwidth: 33.06777 CV score: 7481.648 
#&gt; Bandwidth: 33.06878 CV score: 7481.647 
#&gt; Bandwidth: 33.06941 CV score: 7481.646 
#&gt; Bandwidth: 33.06979 CV score: 7481.645 
#&gt; Bandwidth: 33.07003 CV score: 7481.645 
#&gt; Bandwidth: 33.07018 CV score: 7481.645 
#&gt; Bandwidth: 33.07027 CV score: 7481.645 
#&gt; Bandwidth: 33.07032 CV score: 7481.645 
#&gt; Bandwidth: 33.07037 CV score: 7481.645 
#&gt; Bandwidth: 33.07037 CV score: 7481.645 </div><div class='output co'>#&gt; <span class='warning'>Warning: Bandwidth converged to upper bound:33.0704149683672</span></div><div class='input'><span class='no'>col.bisq</span> <span class='kw'>&lt;-</span> <span class='fu'>gwr</span>(<span class='no'>CRIME</span> ~ <span class='no'>INC</span> + <span class='no'>HOVAL</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>columbus</span>,
  <span class='kw'>coords</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/cbind'>cbind</a></span>(<span class='no'>columbus</span>$<span class='no'>X</span>, <span class='no'>columbus</span>$<span class='no'>Y</span>), <span class='kw'>bandwidth</span><span class='kw'>=</span><span class='no'>col.d</span>,
  <span class='kw'>gweight</span><span class='kw'>=</span><span class='no'>gwr.bisquare</span>, <span class='kw'>hatmatrix</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='no'>col.bisq</span></div><div class='output co'>#&gt; Call:
#&gt; gwr(formula = CRIME ~ INC + HOVAL, data = columbus, coords = cbind(columbus$X, 
#&gt;     columbus$Y), bandwidth = col.d, gweight = gwr.bisquare, hatmatrix = TRUE)
#&gt; Kernel function: gwr.bisquare 
#&gt; Fixed bandwidth: 33.07037 
#&gt; Summary of GWR coefficient estimates at data points:
#&gt;                  Min.  1st Qu.   Median  3rd Qu.     Max.  Global
#&gt; X.Intercept. 68.30731 68.96074 69.26155 69.57103 71.64487 68.6190
#&gt; INC          -1.72665 -1.64754 -1.61378 -1.56908 -1.46759 -1.5973
#&gt; HOVAL        -0.33314 -0.30522 -0.28063 -0.25355 -0.18834 -0.2739
#&gt; Number of data points: 49 
#&gt; Effective number of parameters (residual: 2traceS - traceS'S): 4.604881 
#&gt; Effective degrees of freedom (residual: 2traceS - traceS'S): 44.39512 
#&gt; Sigma (residual: 2traceS - traceS'S): 11.3765 
#&gt; Effective number of parameters (model: traceS): 3.917653 
#&gt; Effective degrees of freedom (model: traceS): 45.08235 
#&gt; Sigma (model: traceS): 11.28946 
#&gt; Sigma (ML): 10.82875 
#&gt; AICc (GWR p. 61, eq 2.33; p. 96, eq. 4.21): 383.6983 
#&gt; AIC (GWR p. 96, eq. 4.22): 376.4297 
#&gt; Residual sum of squares: 5745.83 
#&gt; Quasi-global R2: 0.5724262 </div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='no'>georgia</span>)
<span class='no'>g.adapt.gauss</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='gwr.cv.html'>gwr.sel</a></span>(<span class='no'>PctBach</span> ~ <span class='no'>TotPop90</span> + <span class='no'>PctRural</span> + <span class='no'>PctEld</span> + <span class='no'>PctFB</span> +
 <span class='no'>PctPov</span> + <span class='no'>PctBlack</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>gSRDF</span>, <span class='kw'>adapt</span><span class='kw'>=</span><span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; Adaptive q: 0.381966 CV score: 2048.743 
#&gt; Adaptive q: 0.618034 CV score: 2028.561 
#&gt; Adaptive q: 0.763932 CV score: 2041.554 
#&gt; Adaptive q: 0.593544 CV score: 2027.538 
#&gt; Adaptive q: 0.5306416 CV score: 2026.568 
#&gt; Adaptive q: 0.536485 CV score: 2026.541 
#&gt; Adaptive q: 0.5402641 CV score: 2026.493 
#&gt; Adaptive q: 0.5606152 CV score: 2026.641 
#&gt; Adaptive q: 0.5480375 CV score: 2026.425 
#&gt; Adaptive q: 0.5568526 CV score: 2026.552 
#&gt; Adaptive q: 0.5514046 CV score: 2026.493 
#&gt; Adaptive q: 0.5458334 CV score: 2026.425 
#&gt; Adaptive q: 0.5468793 CV score: 2026.417 
#&gt; Adaptive q: 0.5469222 CV score: 2026.417 
#&gt; Adaptive q: 0.5473482 CV score: 2026.417 
#&gt; Adaptive q: 0.547116 CV score: 2026.416 
#&gt; Adaptive q: 0.5471567 CV score: 2026.415 
#&gt; Adaptive q: 0.5472298 CV score: 2026.416 
#&gt; Adaptive q: 0.5471567 CV score: 2026.415 </div><div class='input'><span class='no'>res.adpt</span> <span class='kw'>&lt;-</span> <span class='fu'>gwr</span>(<span class='no'>PctBach</span> ~ <span class='no'>TotPop90</span> + <span class='no'>PctRural</span> + <span class='no'>PctEld</span> + <span class='no'>PctFB</span> + <span class='no'>PctPov</span> +
 <span class='no'>PctBlack</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>gSRDF</span>, <span class='kw'>adapt</span><span class='kw'>=</span><span class='no'>g.adapt.gauss</span>)
<span class='no'>res.adpt</span></div><div class='output co'>#&gt; Call:
#&gt; gwr(formula = PctBach ~ TotPop90 + PctRural + PctEld + PctFB + 
#&gt;     PctPov + PctBlack, data = gSRDF, adapt = g.adapt.gauss)
#&gt; Kernel function: gwr.Gauss 
#&gt; Adaptive quantile: 0.5471567 (about 86 of 159 data points)
#&gt; Summary of GWR coefficient estimates at data points:
#&gt;                     Min.     1st Qu.      Median     3rd Qu.        Max.
#&gt; X.Intercept.  1.3575e+01  1.4086e+01  1.5223e+01  1.5700e+01  1.5975e+01
#&gt; TotPop90      1.8694e-05  2.0530e-05  2.2791e-05  2.4827e-05  2.5862e-05
#&gt; PctRural     -5.2549e-02 -4.8286e-02 -4.1900e-02 -3.6000e-02 -3.2038e-02
#&gt; PctEld       -1.5889e-01 -1.3354e-01 -1.1456e-01 -9.6816e-02 -5.9114e-02
#&gt; PctFB         8.1590e-01  9.9348e-01  1.3542e+00  1.7432e+00  1.9597e+00
#&gt; PctPov       -1.8387e-01 -1.6427e-01 -1.2554e-01 -9.4889e-02 -6.5134e-02
#&gt; PctBlack     -1.2025e-02 -1.7586e-04  1.1587e-02  2.7628e-02  3.8985e-02
#&gt;               Global
#&gt; X.Intercept. 14.7766
#&gt; TotPop90      0.0000
#&gt; PctRural     -0.0439
#&gt; PctEld       -0.0619
#&gt; PctFB         1.2562
#&gt; PctPov       -0.1554
#&gt; PctBlack      0.0219</div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/pairs'>pairs</a></span>(<span class='fu'>as</span>(<span class='no'>res.adpt</span>$<span class='no'>SDF</span>, <span class='st'>"data.frame"</span>)[,<span class='fl'>2</span>:<span class='fl'>8</span>], <span class='kw'>pch</span><span class='kw'>=</span><span class='st'>"."</span>)</div><div class='img'><img src='gwr-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='no'>brks</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(-<span class='fl'>0.25</span>, <span class='fl'>0</span>, <span class='fl'>0.01</span>, <span class='fl'>0.025</span>, <span class='fl'>0.075</span>)
<span class='no'>cols</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/grDevices/topics/gray'>grey</a></span>(<span class='fl'>5</span>:<span class='fl'>2</span>/<span class='fl'>6</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='no'>res.adpt</span>$<span class='no'>SDF</span>, <span class='kw'>col</span><span class='kw'>=</span><span class='no'>cols</span>[<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/findInterval'>findInterval</a></span>(<span class='no'>res.adpt</span>$<span class='no'>SDF</span>$<span class='no'>PctBlack</span>, <span class='no'>brks</span>,
 <span class='kw'>all.inside</span><span class='kw'>=</span><span class='fl'>TRUE</span>)])</div><div class='img'><img src='gwr-2.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># simulation scenario with patterned dependent variable</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Random'>set.seed</a></span>(<span class='fl'>1</span>)
<span class='no'>X0</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Uniform'>runif</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/nrow'>nrow</a></span>(<span class='no'>gSRDF</span>)*<span class='fl'>3</span>)
<span class='no'>X1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/matrix'>matrix</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/sample'>sample</a></span>(<span class='no'>X0</span>), <span class='kw'>ncol</span><span class='kw'>=</span><span class='fl'>3</span>)
<span class='no'>X1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/prcomp'>prcomp</a></span>(<span class='no'>X1</span>, <span class='kw'>center</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>scale.</span><span class='kw'>=</span><span class='fl'>FALSE</span>)$<span class='no'>x</span>
<span class='no'>gSRDF</span>$<span class='no'>X1</span> <span class='kw'>&lt;-</span> <span class='no'>X1</span>[,<span class='fl'>1</span>]
<span class='no'>gSRDF</span>$<span class='no'>X2</span> <span class='kw'>&lt;-</span> <span class='no'>X1</span>[,<span class='fl'>2</span>]
<span class='no'>gSRDF</span>$<span class='no'>X3</span> <span class='kw'>&lt;-</span> <span class='no'>X1</span>[,<span class='fl'>3</span>]
<span class='no'>bw</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='gwr.cv.html'>gwr.sel</a></span>(<span class='no'>PctBach</span> ~ <span class='no'>X1</span> + <span class='no'>X2</span> + <span class='no'>X3</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>gSRDF</span>, <span class='kw'>verbose</span><span class='kw'>=</span><span class='fl'>FALSE</span>)
<span class='no'>out</span> <span class='kw'>&lt;-</span> <span class='fu'>gwr</span>(<span class='no'>PctBach</span> ~ <span class='no'>X1</span> + <span class='no'>X2</span> + <span class='no'>X3</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>gSRDF</span>, <span class='kw'>bandwidth</span><span class='kw'>=</span><span class='no'>bw</span>, <span class='kw'>hatmatrix</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='no'>out</span></div><div class='output co'>#&gt; Call:
#&gt; gwr(formula = PctBach ~ X1 + X2 + X3, data = gSRDF, bandwidth = bw, 
#&gt;     hatmatrix = TRUE)
#&gt; Kernel function: gwr.Gauss 
#&gt; Fixed bandwidth: 110.6154 
#&gt; Summary of GWR coefficient estimates at data points:
#&gt;                  Min.  1st Qu.   Median  3rd Qu.     Max.  Global
#&gt; X.Intercept.  9.62969 11.37102 12.12441 12.45626 16.57710 11.9185
#&gt; X1           -3.01969 -0.92548  0.76991  2.94648  8.05897  1.1207
#&gt; X2           -1.90043 -0.52884  0.39507  1.24109  2.62356  0.1101
#&gt; X3           -1.89215 -1.20383 -0.89221 -0.59953  2.76253 -0.6651
#&gt; Number of data points: 159 
#&gt; Effective number of parameters (residual: 2traceS - traceS'S): 18.6778 
#&gt; Effective degrees of freedom (residual: 2traceS - traceS'S): 140.3222 
#&gt; Sigma (residual: 2traceS - traceS'S): 5.61671 
#&gt; Effective number of parameters (model: traceS): 13.51451 
#&gt; Effective degrees of freedom (model: traceS): 145.4855 
#&gt; Sigma (model: traceS): 5.516141 
#&gt; Sigma (ML): 5.276509 
#&gt; AICc (GWR p. 61, eq 2.33; p. 96, eq. 4.21): 1012.308 
#&gt; AIC (GWR p. 96, eq. 4.22): 993.6551 
#&gt; Residual sum of squares: 4426.805 
#&gt; Quasi-global R2: 0.1367513 </div><div class='input'><span class='fu'>spplot</span>(<span class='no'>gSRDF</span>, <span class='st'>"PctBach"</span>, <span class='kw'>col.regions</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/grDevices/topics/gray.colors'>grey.colors</a></span>(<span class='fl'>20</span>))</div><div class='img'><img src='gwr-3.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'>spplot</span>(<span class='no'>gSRDF</span>, <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"X1"</span>, <span class='st'>"X2"</span>, <span class='st'>"X3"</span>), <span class='kw'>col.regions</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/grDevices/topics/gray.colors'>grey.colors</a></span>(<span class='fl'>20</span>))</div><div class='img'><img src='gwr-4.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># pattern in the local coefficients</span>
<span class='fu'>spplot</span>(<span class='no'>out</span>$<span class='no'>SDF</span>, <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"X1"</span>, <span class='st'>"X2"</span>, <span class='st'>"X3"</span>), <span class='kw'>col.regions</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/grDevices/topics/gray.colors'>grey.colors</a></span>(<span class='fl'>20</span>))</div><div class='img'><img src='gwr-5.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># but no "significant" pattern</span>
<span class='fu'>spplot</span>(<span class='no'>out</span>$<span class='no'>SDF</span>, <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"X1_se"</span>, <span class='st'>"X2_se"</span>, <span class='st'>"X3_se"</span>), <span class='kw'>col.regions</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/grDevices/topics/gray.colors'>grey.colors</a></span>(<span class='fl'>20</span>))</div><div class='img'><img src='gwr-6.png' alt='' width='700' height='433' /></div><div class='input'><span class='no'>out</span>$<span class='no'>SDF</span>$<span class='no'>X1_t</span> <span class='kw'>&lt;-</span> <span class='no'>out</span>$<span class='no'>SDF</span>$<span class='no'>X1</span>/<span class='no'>out</span>$<span class='no'>SDF</span>$<span class='no'>X1_se</span>
<span class='no'>out</span>$<span class='no'>SDF</span>$<span class='no'>X2_t</span> <span class='kw'>&lt;-</span> <span class='no'>out</span>$<span class='no'>SDF</span>$<span class='no'>X2</span>/<span class='no'>out</span>$<span class='no'>SDF</span>$<span class='no'>X2_se</span>
<span class='no'>out</span>$<span class='no'>SDF</span>$<span class='no'>X3_t</span> <span class='kw'>&lt;-</span> <span class='no'>out</span>$<span class='no'>SDF</span>$<span class='no'>X3</span>/<span class='no'>out</span>$<span class='no'>SDF</span>$<span class='no'>X3_se</span>
<span class='fu'>spplot</span>(<span class='no'>out</span>$<span class='no'>SDF</span>, <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"X1_t"</span>, <span class='st'>"X2_t"</span>, <span class='st'>"X3_t"</span>), <span class='kw'>col.regions</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/grDevices/topics/gray.colors'>grey.colors</a></span>(<span class='fl'>20</span>))</div><div class='img'><img src='gwr-7.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># simulation scenario with random dependent variable</span>
<span class='no'>yrn</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Normal'>rnorm</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/nrow'>nrow</a></span>(<span class='no'>gSRDF</span>))
<span class='no'>gSRDF</span>$<span class='no'>yrn</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/sample'>sample</a></span>(<span class='no'>yrn</span>)
<span class='no'>bw</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='gwr.cv.html'>gwr.sel</a></span>(<span class='no'>yrn</span> ~ <span class='no'>X1</span> + <span class='no'>X2</span> + <span class='no'>X3</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>gSRDF</span>, <span class='kw'>verbose</span><span class='kw'>=</span><span class='fl'>FALSE</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: Bandwidth converged to upper bound:620.559306125037</span></div><div class='input'><span class='co'># bandwidth selection maxes out at 620 km, equal to upper bound</span>
<span class='co'># of line search</span>
<span class='no'>out</span> <span class='kw'>&lt;-</span> <span class='fu'>gwr</span>(<span class='no'>yrn</span> ~ <span class='no'>X1</span> + <span class='no'>X2</span> + <span class='no'>X3</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>gSRDF</span>, <span class='kw'>bandwidth</span><span class='kw'>=</span><span class='no'>bw</span>, <span class='kw'>hatmatrix</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='no'>out</span></div><div class='output co'>#&gt; Call:
#&gt; gwr(formula = yrn ~ X1 + X2 + X3, data = gSRDF, bandwidth = bw, 
#&gt;     hatmatrix = TRUE)
#&gt; Kernel function: gwr.Gauss 
#&gt; Fixed bandwidth: 620.5592 
#&gt; Summary of GWR coefficient estimates at data points:
#&gt;                    Min.    1st Qu.     Median    3rd Qu.       Max.  Global
#&gt; X.Intercept. -0.0620260 -0.0400498 -0.0234750 -0.0081430  0.0114714 -0.0206
#&gt; X1           -0.0379228 -0.0138990  0.0014142  0.0162179  0.0374280  0.0038
#&gt; X2           -0.0079416 -0.0024262  0.0020421  0.0074084  0.0158631  0.0111
#&gt; X3           -0.0195718  0.0015668  0.0120498  0.0255119  0.0503870  0.0087
#&gt; Number of data points: 159 
#&gt; Effective number of parameters (residual: 2traceS - traceS'S): 4.549237 
#&gt; Effective degrees of freedom (residual: 2traceS - traceS'S): 154.4508 
#&gt; Sigma (residual: 2traceS - traceS'S): 1.079238 
#&gt; Effective number of parameters (model: traceS): 4.281395 
#&gt; Effective degrees of freedom (model: traceS): 154.7186 
#&gt; Sigma (model: traceS): 1.078303 
#&gt; Sigma (ML): 1.063686 
#&gt; AICc (GWR p. 61, eq 2.33; p. 96, eq. 4.21): 481.8531 
#&gt; AIC (GWR p. 96, eq. 4.22): 475.1373 
#&gt; Residual sum of squares: 179.8971 
#&gt; Quasi-global R2: 0.003021387 </div><div class='input'><span class='fu'>spplot</span>(<span class='no'>gSRDF</span>, <span class='st'>"yrn"</span>, <span class='kw'>col.regions</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/grDevices/topics/gray.colors'>grey.colors</a></span>(<span class='fl'>20</span>))</div><div class='img'><img src='gwr-8.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'>spplot</span>(<span class='no'>gSRDF</span>, <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"X1"</span>, <span class='st'>"X2"</span>, <span class='st'>"X3"</span>), <span class='kw'>col.regions</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/grDevices/topics/gray.colors'>grey.colors</a></span>(<span class='fl'>20</span>))</div><div class='img'><img src='gwr-9.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># pattern in the local coefficients</span>
<span class='fu'>spplot</span>(<span class='no'>out</span>$<span class='no'>SDF</span>, <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"X1"</span>, <span class='st'>"X2"</span>, <span class='st'>"X3"</span>), <span class='kw'>col.regions</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/grDevices/topics/gray.colors'>grey.colors</a></span>(<span class='fl'>20</span>))</div><div class='img'><img src='gwr-10.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># but no "significant" pattern</span>
<span class='fu'>spplot</span>(<span class='no'>out</span>$<span class='no'>SDF</span>, <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"X1_se"</span>, <span class='st'>"X2_se"</span>, <span class='st'>"X3_se"</span>), <span class='kw'>col.regions</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/grDevices/topics/gray.colors'>grey.colors</a></span>(<span class='fl'>20</span>))</div><div class='img'><img src='gwr-11.png' alt='' width='700' height='433' /></div><div class='input'><span class='no'>out</span>$<span class='no'>SDF</span>$<span class='no'>X1_t</span> <span class='kw'>&lt;-</span> <span class='no'>out</span>$<span class='no'>SDF</span>$<span class='no'>X1</span>/<span class='no'>out</span>$<span class='no'>SDF</span>$<span class='no'>X1_se</span>
<span class='no'>out</span>$<span class='no'>SDF</span>$<span class='no'>X2_t</span> <span class='kw'>&lt;-</span> <span class='no'>out</span>$<span class='no'>SDF</span>$<span class='no'>X2</span>/<span class='no'>out</span>$<span class='no'>SDF</span>$<span class='no'>X2_se</span>
<span class='no'>out</span>$<span class='no'>SDF</span>$<span class='no'>X3_t</span> <span class='kw'>&lt;-</span> <span class='no'>out</span>$<span class='no'>SDF</span>$<span class='no'>X3</span>/<span class='no'>out</span>$<span class='no'>SDF</span>$<span class='no'>X3_se</span>
<span class='fu'>spplot</span>(<span class='no'>out</span>$<span class='no'>SDF</span>, <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"X1_t"</span>, <span class='st'>"X2_t"</span>, <span class='st'>"X3_t"</span>), <span class='kw'>col.regions</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/grDevices/topics/gray.colors'>grey.colors</a></span>(<span class='fl'>20</span>))</div><div class='img'><img src='gwr-12.png' alt='' width='700' height='433' /></div><div class='input'># end of simulations
</div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='no'>meuse</span>)
<span class='fu'>coordinates</span>(<span class='no'>meuse</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"x"</span>, <span class='st'>"y"</span>)
<span class='no'>meuse</span>$<span class='no'>ffreq</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/factor'>factor</a></span>(<span class='no'>meuse</span>$<span class='no'>ffreq</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='no'>meuse.grid</span>)
<span class='fu'>coordinates</span>(<span class='no'>meuse.grid</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"x"</span>, <span class='st'>"y"</span>)
<span class='no'>meuse.grid</span>$<span class='no'>ffreq</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/factor'>factor</a></span>(<span class='no'>meuse.grid</span>$<span class='no'>ffreq</span>)
<span class='fu'>gridded</span>(<span class='no'>meuse.grid</span>) <span class='kw'>&lt;-</span> <span class='fl'>TRUE</span>
<span class='no'>xx</span> <span class='kw'>&lt;-</span> <span class='fu'>gwr</span>(<span class='no'>cadmium</span> ~ <span class='no'>dist</span>, <span class='no'>meuse</span>, <span class='kw'>bandwidth</span> <span class='kw'>=</span> <span class='fl'>228</span>, <span class='kw'>hatmatrix</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='no'>xx</span></div><div class='output co'>#&gt; Call:
#&gt; gwr(formula = cadmium ~ dist, data = meuse, bandwidth = 228, 
#&gt;     hatmatrix = TRUE)
#&gt; Kernel function: gwr.Gauss 
#&gt; Fixed bandwidth: 228 
#&gt; Summary of GWR coefficient estimates at data points:
#&gt;                  Min.  1st Qu.   Median  3rd Qu.     Max.   Global
#&gt; X.Intercept.   1.2899   3.7496   5.6463   7.2603  12.9459   5.8795
#&gt; dist         -36.2255 -20.5680 -12.5101  -6.3063  12.1979 -10.9730
#&gt; Number of data points: 155 
#&gt; Effective number of parameters (residual: 2traceS - traceS'S): 33.66762 
#&gt; Effective degrees of freedom (residual: 2traceS - traceS'S): 121.3324 
#&gt; Sigma (residual: 2traceS - traceS'S): 2.172593 
#&gt; Effective number of parameters (model: traceS): 25.01465 
#&gt; Effective degrees of freedom (model: traceS): 129.9854 
#&gt; Sigma (model: traceS): 2.099034 
#&gt; Sigma (ML): 1.92221 
#&gt; AICc (GWR p. 61, eq 2.33; p. 96, eq. 4.21): 705.4599 
#&gt; AIC (GWR p. 96, eq. 4.22): 667.4631 
#&gt; Residual sum of squares: 572.7084 
#&gt; Quasi-global R2: 0.7004953 </div><div class='input'><span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'>gwr</span>(<span class='no'>cadmium</span> ~ <span class='no'>dist</span>, <span class='no'>meuse</span>, <span class='kw'>bandwidth</span> <span class='kw'>=</span> <span class='fl'>228</span>, <span class='kw'>fit.points</span> <span class='kw'>=</span> <span class='no'>meuse.grid</span>,
 <span class='kw'>predict</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>se.fit</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>fittedGWRobject</span><span class='kw'>=</span><span class='no'>xx</span>)
<span class='no'>x</span></div><div class='output co'>#&gt; Call:
#&gt; gwr(formula = cadmium ~ dist, data = meuse, bandwidth = 228, 
#&gt;     fit.points = meuse.grid, se.fit = TRUE, predictions = TRUE, 
#&gt;     fittedGWRobject = xx)
#&gt; Kernel function: gwr.Gauss 
#&gt; Fixed bandwidth: 228 
#&gt; Fit points: 3103
#&gt; Summary of GWR coefficient estimates at fit points:
#&gt;                  Min.  1st Qu.   Median  3rd Qu.   Max.
#&gt; X.Intercept.   1.2675   3.1758   4.7424   6.7630 14.151
#&gt; dist         -39.2780 -16.4603  -8.9569  -4.6925 21.183</div><div class='input'><span class='fu'>spplot</span>(<span class='no'>x</span>$<span class='no'>SDF</span>, <span class='st'>"pred"</span>)</div><div class='img'><img src='gwr-13.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'>spplot</span>(<span class='no'>x</span>$<span class='no'>SDF</span>, <span class='st'>"pred.se"</span>)</div><div class='img'><img src='gwr-14.png' alt='' width='700' height='433' /></div><div class='input'>  <span class='no'>g.bw.gauss</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='gwr.cv.html'>gwr.sel</a></span>(<span class='no'>PctBach</span> ~ <span class='no'>TotPop90</span> + <span class='no'>PctRural</span> + <span class='no'>PctEld</span> + <span class='no'>PctFB</span> +
    <span class='no'>PctPov</span> + <span class='no'>PctBlack</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>gSRDF</span>)</div><div class='output co'>#&gt; Bandwidth: 237.4161 CV score: 2006.252 
#&gt; Bandwidth: 383.7638 CV score: 2055.058 
#&gt; Bandwidth: 146.9682 CV score: 2003.055 
#&gt; Bandwidth: 178.1538 CV score: 1987.199 
#&gt; Bandwidth: 190.266 CV score: 1988.559 
#&gt; Bandwidth: 180.2927 CV score: 1987.247 
#&gt; Bandwidth: 177.9721 CV score: 1987.199 
#&gt; Bandwidth: 178.1517 CV score: 1987.199 
#&gt; Bandwidth: 178.1493 CV score: 1987.199 
#&gt; Bandwidth: 178.1493 CV score: 1987.199 
#&gt; Bandwidth: 178.1494 CV score: 1987.199 
#&gt; Bandwidth: 178.1493 CV score: 1987.199 </div><div class='input'>  <span class='no'>res.bw</span> <span class='kw'>&lt;-</span> <span class='fu'>gwr</span>(<span class='no'>PctBach</span> ~ <span class='no'>TotPop90</span> + <span class='no'>PctRural</span> + <span class='no'>PctEld</span> + <span class='no'>PctFB</span> + <span class='no'>PctPov</span> +
    <span class='no'>PctBlack</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>gSRDF</span>, <span class='kw'>bandwidth</span><span class='kw'>=</span><span class='no'>g.bw.gauss</span>)
  <span class='no'>res.bw</span></div><div class='output co'>#&gt; Call:
#&gt; gwr(formula = PctBach ~ TotPop90 + PctRural + PctEld + PctFB + 
#&gt;     PctPov + PctBlack, data = gSRDF, bandwidth = g.bw.gauss)
#&gt; Kernel function: gwr.Gauss 
#&gt; Fixed bandwidth: 178.1493 
#&gt; Summary of GWR coefficient estimates at data points:
#&gt;                     Min.     1st Qu.      Median     3rd Qu.        Max.
#&gt; X.Intercept.  1.1666e+01  1.4068e+01  1.5289e+01  1.5934e+01  1.6147e+01
#&gt; TotPop90      1.5831e-05  1.9534e-05  2.2701e-05  2.5424e-05  2.8574e-05
#&gt; PctRural     -6.2059e-02 -4.9325e-02 -4.1551e-02 -3.5341e-02 -2.2447e-02
#&gt; PctEld       -1.6301e-01 -1.4169e-01 -1.3295e-01 -1.0983e-01 -4.7004e-02
#&gt; PctFB         5.2021e-01  8.8200e-01  1.3709e+00  1.8733e+00  2.3618e+00
#&gt; PctPov       -2.0236e-01 -1.6641e-01 -1.2167e-01 -7.8814e-02 -2.0659e-02
#&gt; PctBlack     -2.0569e-02 -3.9872e-03  9.0175e-03  3.2119e-02  6.6879e-02
#&gt;               Global
#&gt; X.Intercept. 14.7766
#&gt; TotPop90      0.0000
#&gt; PctRural     -0.0439
#&gt; PctEld       -0.0619
#&gt; PctFB         1.2562
#&gt; PctPov       -0.1554
#&gt; PctBlack      0.0219</div><div class='input'>  <span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/pairs'>pairs</a></span>(<span class='fu'>as</span>(<span class='no'>res.bw</span>$<span class='no'>SDF</span>, <span class='st'>"data.frame"</span>)[,<span class='fl'>2</span>:<span class='fl'>8</span>], <span class='kw'>pch</span><span class='kw'>=</span><span class='st'>"."</span>)</div><div class='img'><img src='gwr-15.png' alt='' width='700' height='433' /></div><div class='input'>  <span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='no'>res.bw</span>$<span class='no'>SDF</span>, <span class='kw'>col</span><span class='kw'>=</span><span class='no'>cols</span>[<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/findInterval'>findInterval</a></span>(<span class='no'>res.bw</span>$<span class='no'>SDF</span>$<span class='no'>PctBlack</span>, <span class='no'>brks</span>,
    <span class='kw'>all.inside</span><span class='kw'>=</span><span class='fl'>TRUE</span>)])</div><div class='img'><img src='gwr-16.png' alt='' width='700' height='433' /></div><div class='input'>  <span class='no'>g.bw.gauss</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='gwr.cv.html'>gwr.sel</a></span>(<span class='no'>PctBach</span> ~ <span class='no'>TotPop90</span> + <span class='no'>PctRural</span> + <span class='no'>PctEld</span> + <span class='no'>PctFB</span> +
    <span class='no'>PctPov</span> + <span class='no'>PctBlack</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>gSRDF</span>, <span class='kw'>longlat</span><span class='kw'>=</span><span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; Bandwidth: 237.4161 CV score: 2006.252 
#&gt; Bandwidth: 383.7638 CV score: 2055.058 
#&gt; Bandwidth: 146.9682 CV score: 2003.055 
#&gt; Bandwidth: 178.1538 CV score: 1987.199 
#&gt; Bandwidth: 190.266 CV score: 1988.559 
#&gt; Bandwidth: 180.2927 CV score: 1987.247 
#&gt; Bandwidth: 177.9721 CV score: 1987.199 
#&gt; Bandwidth: 178.1517 CV score: 1987.199 
#&gt; Bandwidth: 178.1493 CV score: 1987.199 
#&gt; Bandwidth: 178.1493 CV score: 1987.199 
#&gt; Bandwidth: 178.1494 CV score: 1987.199 
#&gt; Bandwidth: 178.1493 CV score: 1987.199 </div><div class='input'>  <span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='no'>gSRouter</span>)
  <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>require</a></span>(<span class='no'>maptools</span>)</div><div class='output co'>#&gt; <span class='message'>Loading required package: maptools</span></div><div class='output co'>#&gt; <span class='message'>Checking rgeos availability: TRUE</span></div><div class='input'>  <span class='no'>SG</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/maptools/topics/GE_SpatialGrid'>GE_SpatialGrid</a></span>(<span class='no'>gSRouter</span>, <span class='kw'>maxPixels</span> <span class='kw'>=</span> <span class='fl'>100</span>)
  <span class='no'>SPxMASK0</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/grDevices/topics/plotmath'>over</a></span>(<span class='no'>SG</span>$<span class='no'>SG</span>, <span class='no'>gSRouter</span>)
  <span class='no'>SGDF</span> <span class='kw'>&lt;-</span> <span class='fu'>SpatialGridDataFrame</span>(<span class='fu'>slot</span>(<span class='no'>SG</span>$<span class='no'>SG</span>, <span class='st'>"grid"</span>),
    <span class='kw'>data</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/data.frame'>data.frame</a></span>(<span class='kw'>SPxMASK0</span><span class='kw'>=</span><span class='no'>SPxMASK0</span>),
    <span class='kw'>proj4string</span><span class='kw'>=</span><span class='fu'>CRS</span>(<span class='fu'>proj4string</span>(<span class='no'>gSRouter</span>)))
  <span class='no'>SPxDF</span> <span class='kw'>&lt;-</span> <span class='fu'>as</span>(<span class='no'>SGDF</span>, <span class='st'>"SpatialPixelsDataFrame"</span>)
  <span class='no'>res.bw</span> <span class='kw'>&lt;-</span> <span class='fu'>gwr</span>(<span class='no'>PctBach</span> ~ <span class='no'>TotPop90</span> + <span class='no'>PctRural</span> + <span class='no'>PctEld</span> + <span class='no'>PctFB</span> + <span class='no'>PctPov</span> +
    <span class='no'>PctBlack</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>gSRDF</span>, <span class='kw'>bandwidth</span><span class='kw'>=</span><span class='no'>g.bw.gauss</span>, <span class='kw'>fit.points</span><span class='kw'>=</span><span class='no'>SPxDF</span>,
    <span class='kw'>longlat</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
  <span class='no'>res.bw</span></div><div class='output co'>#&gt; Call:
#&gt; gwr(formula = PctBach ~ TotPop90 + PctRural + PctEld + PctFB + 
#&gt;     PctPov + PctBlack, data = gSRDF, bandwidth = g.bw.gauss, 
#&gt;     fit.points = SPxDF, longlat = TRUE)
#&gt; Kernel function: gwr.Gauss 
#&gt; Fixed bandwidth: 178.1493 
#&gt; Fit points: 5736
#&gt; Summary of GWR coefficient estimates at fit points:
#&gt;                     Min.     1st Qu.      Median     3rd Qu.    Max.
#&gt; X.Intercept.  1.1492e+01  1.4262e+01  1.5529e+01  1.5980e+01 16.1807
#&gt; TotPop90      1.5194e-05  2.0026e-05  2.3091e-05  2.5914e-05  0.0000
#&gt; PctRural     -6.3755e-02 -5.1313e-02 -4.3510e-02 -3.6052e-02 -0.0218
#&gt; PctEld       -1.6931e-01 -1.4104e-01 -1.2839e-01 -1.0047e-01 -0.0387
#&gt; PctFB         4.3101e-01  8.1250e-01  1.2548e+00  1.7992e+00  2.4011
#&gt; PctPov       -2.0726e-01 -1.7199e-01 -1.3266e-01 -8.4660e-02 -0.0145
#&gt; PctBlack     -2.3266e-02 -2.4655e-03  1.2753e-02  3.6330e-02  0.0722</div><div class='input'>  <span class='no'>res.bw</span>$<span class='no'>timings</span></div><div class='output co'>#&gt;                   user.self elapsed
#&gt; set_up                0.002   0.001
#&gt; run_gwr               0.791   0.802
#&gt; final_postprocess     0.011   0.010</div><div class='input'>  <span class='fu'>spplot</span>(<span class='no'>res.bw</span>$<span class='no'>SDF</span>, <span class='st'>"PctBlack"</span>)</div><div class='img'><img src='gwr-17.png' alt='' width='700' height='433' /></div><div class='input'>  <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>require</a></span>(<span class='no'>parallel</span>)</div><div class='output co'>#&gt; <span class='message'>Loading required package: parallel</span></div><div class='input'>  <span class='no'>cl</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/parallel/topics/makeCluster'>makeCluster</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/parallel/topics/detectCores'>detectCores</a></span>())
  <span class='no'>res.bwc</span> <span class='kw'>&lt;-</span> <span class='fu'>gwr</span>(<span class='no'>PctBach</span> ~ <span class='no'>TotPop90</span> + <span class='no'>PctRural</span> + <span class='no'>PctEld</span> + <span class='no'>PctFB</span> + <span class='no'>PctPov</span> +
    <span class='no'>PctBlack</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>gSRDF</span>, <span class='kw'>bandwidth</span><span class='kw'>=</span><span class='no'>g.bw.gauss</span>, <span class='kw'>fit.points</span><span class='kw'>=</span><span class='no'>SPxDF</span>,
    <span class='kw'>longlat</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>cl</span><span class='kw'>=</span><span class='no'>cl</span>)
  <span class='no'>res.bwc</span></div><div class='output co'>#&gt; Call:
#&gt; gwr(formula = PctBach ~ TotPop90 + PctRural + PctEld + PctFB + 
#&gt;     PctPov + PctBlack, data = gSRDF, bandwidth = g.bw.gauss, 
#&gt;     fit.points = SPxDF, longlat = TRUE, cl = cl)
#&gt; Kernel function: gwr.Gauss 
#&gt; Fixed bandwidth: 178.1493 178.1493 178.1493 178.1493 
#&gt; Fit points: 5736
#&gt; Summary of GWR coefficient estimates at fit points:
#&gt;                     Min.     1st Qu.      Median     3rd Qu.    Max.
#&gt; X.Intercept.  1.1492e+01  1.4262e+01  1.5529e+01  1.5980e+01 16.1807
#&gt; TotPop90      1.5194e-05  2.0026e-05  2.3091e-05  2.5914e-05  0.0000
#&gt; PctRural     -6.3755e-02 -5.1313e-02 -4.3510e-02 -3.6052e-02 -0.0218
#&gt; PctEld       -1.6931e-01 -1.4104e-01 -1.2839e-01 -1.0047e-01 -0.0387
#&gt; PctFB         4.3101e-01  8.1250e-01  1.2548e+00  1.7992e+00  2.4011
#&gt; PctPov       -2.0726e-01 -1.7199e-01 -1.3266e-01 -8.4660e-02 -0.0145
#&gt; PctBlack     -2.3266e-02 -2.4655e-03  1.2753e-02  3.6330e-02  0.0722</div><div class='input'>  <span class='no'>res.bwc</span>$<span class='no'>timings</span></div><div class='output co'>#&gt;                   user.self elapsed
#&gt; set_up                0.002   0.003
#&gt; run_gwr               0.047   0.612
#&gt; final_postprocess     0.019   0.021</div><div class='input'>  <span class='fu'><a href='https://www.rdocumentation.org/packages/parallel/topics/makeCluster'>stopCluster</a></span>(<span class='no'>cl</span>)</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>

      <li><a href="#value">Value</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Roger Bivand <a href='mailto:Roger.Bivand@nhh.no'>Roger.Bivand@nhh.no</a></p>
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Roger Bivand, Danlin Yu.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

